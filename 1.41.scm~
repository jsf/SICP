(define (double f)
  (lambda (x) (f (f x))))

(define (inc n)
  (+ n 1))  

((double inc) 1)
((double inc) 2)
((double inc) 3)
((double inc) 4)
((double inc) 5)

(((double (double double)) inc) 5)
;21
(((double double) inc) 5)
;9
(((double (double (double double))) inc) 5)
;261

((double (double (double inc))) 5)
((double (double (lambda (x) (inc (inc x))))) 5)
((double (lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x)))) 5)
((lambda (x) ((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) ((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) x))) 5)
((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) ((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) 5))
((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) 5)))
((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) ((lambda (x) (inc (inc x))) (inc (inc 5))))
((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) ((lambda (x) (inc (inc x))) 7))
((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) (inc (inc 7)))
((lambda (x) ((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) x))) 9)
((lambda (x) (inc (inc x))) ((lambda (x) (inc (inc x))) 9))
((lambda (x) (inc (inc x))) (inc (inc 9)))
((lambda (x) (inc (inc x))) 11)
(inc (inc 11))
13

;(((double (double (lambda (f) (lambda (n) (f (f n))))))) inc)
(((double (double double)) inc) 5)
(((double (lambda (n) (double (double n)))) inc) 5)
(((lambda (n) ((lambda (n) (double (double n)))
               ((lambda (n) (double (double n))) n))) inc) 5)
(((lambda (n) (double (double n)))
  ((lambda (n) (double (double n))) inc)) 5)
(((lambda (n) (double (double n)))
  (double (double inc))) 5)
((double (double (double (double inc)))) 5)
((double (double (double (lambda (n) (inc (inc n)))))) 5)
((double (double (lambda (n) ((lambda (n) (inc (inc n)))
                              ((lambda (n) (inc (inc n))) n))))) 5)
((double (lambda (n)
           ((lambda (n) ((lambda (n) (inc (inc n)))
                         ((lambda (n) (inc (inc n))) n)))
            ((lambda (n) ((lambda (n) (inc (inc n)))
                          ((lambda (n) (inc (inc n))) n))) n)))) 5)
;-------------
((lambda (n)
   ((lambda (n)
      ((lambda (n) ((lambda (n) (inc (inc n)))
                    ((lambda (n) (inc (inc n))) n)))
       ((lambda (n) ((lambda (n) (inc (inc n)))
                     ((lambda (n) (inc (inc n))) n))) n)))
    ((lambda (n)
       ((lambda (n) ((lambda (n) (inc (inc n)))
                     ((lambda (n) (inc (inc n))) n)))
        ((lambda (n) ((lambda (n) (inc (inc n)))
                      ((lambda (n) (inc (inc n))) n))) n))) n))) 5)

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n)
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n)))
     ((lambda (n) ((lambda (n) (inc (inc n)))
                   ((lambda (n) (inc (inc n))) n))) n))) 5))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) ((lambda (n) (inc (inc n)))
               ((lambda (n) (inc (inc n))) n)))
  ((lambda (n) ((lambda (n) (inc (inc n)))
                ((lambda (n) (inc (inc n))) n))) 5)))
;Repeated?:
;((lambda (n)
;   ((lambda (n) ((lambda (n) (inc (inc n)))
;                 ((lambda (n) (inc (inc n))) n)))
;    ((lambda (n) ((lambda (n) (inc (inc n)))
;                  ((lambda (n) (inc (inc n))) n))) n)))
; ((lambda (n) ((lambda (n) (inc (inc n)))
;               ((lambda (n) (inc (inc n))) n)))
;  ((lambda (n) ((lambda (n) (inc (inc n)))
;                ((lambda (n) (inc (inc n))) n))) 5)))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) ((lambda (n) (inc (inc n)))
               ((lambda (n) (inc (inc n))) n)))
  ((lambda (n) (inc (inc n)))
   ((lambda (n) (inc (inc n))) 5))))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) ((lambda (n) (inc (inc n)))
               ((lambda (n) (inc (inc n))) n)))
  ((lambda (n) (inc (inc n)))
   (inc (inc 5)))))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) ((lambda (n) (inc (inc n)))
               ((lambda (n) (inc (inc n))) n)))
  ((lambda (n) (inc (inc n)))
   7)))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) ((lambda (n) (inc (inc n)))
               ((lambda (n) (inc (inc n))) n)))
  (inc (inc 7))))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) ((lambda (n) (inc (inc n)))
               ((lambda (n) (inc (inc n))) n)))
  9))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) (inc (inc n)))
  ((lambda (n) (inc (inc n))) 9)))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) (inc (inc n)))
  (inc (inc 9))))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 ((lambda (n) (inc (inc n)))
  11))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 (inc (inc 11)))

((lambda (n)
   ((lambda (n) ((lambda (n) (inc (inc n)))
                 ((lambda (n) (inc (inc n))) n)))
    ((lambda (n) ((lambda (n) (inc (inc n)))
                  ((lambda (n) (inc (inc n))) n))) n)))
 13)

((lambda (n) ((lambda (n) (inc (inc n)))
              ((lambda (n) (inc (inc n))) n)))
 ((lambda (n) ((lambda (n) (inc (inc n)))
               ((lambda (n) (inc (inc n))) n))) 13))

((lambda (n) ((lambda (n) (inc (inc n)))
              ((lambda (n) (inc (inc n))) n)))
 ((lambda (n) (inc (inc n)))
  ((lambda (n) (inc (inc n))) 13)))

((lambda (n) ((lambda (n) (inc (inc n)))
              ((lambda (n) (inc (inc n))) n)))
 ((lambda (n) (inc (inc n)))
  (inc (inc 13))))

((lambda (n) ((lambda (n) (inc (inc n)))
              ((lambda (n) (inc (inc n))) n)))
 ((lambda (n) (inc (inc n)))
  15))

((lambda (n) ((lambda (n) (inc (inc n)))
              ((lambda (n) (inc (inc n))) n)))
 (inc (inc 15)))
 
((lambda (n) ((lambda (n) (inc (inc n)))
              ((lambda (n) (inc (inc n))) n)))
 17)
 
((lambda (n) (inc (inc n)))
 ((lambda (n) (inc (inc n))) 17))

((lambda (n) (inc (inc n)))
 (inc (inc 17)))

((lambda (n) (inc (inc n)))
 19)

(inc (inc 19))

21

